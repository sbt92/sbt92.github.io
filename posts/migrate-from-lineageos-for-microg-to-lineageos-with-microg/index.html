<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The personal website of Sam Tripp"><link rel="shortcut icon" href=https://www.samtripp.co.uk/favicon.ico><link rel=stylesheet href=/css/style.min.css><link rel=canonical href=https://www.samtripp.co.uk/posts/migrate-from-lineageos-for-microg-to-lineageos-with-microg/><title>Migrate from LineageOS for microG to LineageOS with microG</title></head><body><header id=banner><h2><a href=https://www.samtripp.co.uk>Sam Tripp</a></h2><nav><ul><li><a href=/ title=posts>posts</a></li><li><a href=/about/ title=about>about</a></li><li><a href=/posts/index.xml title=rss>rss</a></li></ul></nav></header><main id=content><article><header id=post-header><h1>Migrate from LineageOS for microG to LineageOS with microG</h1><div><time>12 April 2024</time></div></header><p>I&rsquo;ve decided to migrate my phones OS from <a href=https://lineage.microg.org/>LineageOS for microG</a> to <a href=https://lineageos.org/>LineageOS</a> with <a href=https://microg.org/>microG</a> and I&rsquo;ve documented my process of doing this.</p><h1 id=why-use-lineageos>Why use LineageOS</h1><p>I&rsquo;ve ran LineageOS back when it was called Cynogenmod on my OnePlusOne and I&rsquo;ve stuck to it ever since on my Android phones. I liked how it was a clean consistent Android OS which was well supported across many phones meaning if my device broke and was beyond economical repair I can get a new supported device and enjoy the same experience that I had before. It also prolongs the life of my phones as the majority of phones will get 2 to 3 years OS updates from manufacturers whereas LineageOS is still providing updates for my previous phone, a Xiaomi Pocophone F1 which was released in 2018. This allows me to run a system with the latest android securirty patches and reduces the creation of unnessecary e-waste.</p><h1 id=why-use-microg>Why use microG</h1><p>It may be no great surprise to anyone how much information Google collects on any given person but people may overlook how much data the Google Play services collect on you. I can&rsquo;t tell you exactly how much they collect or what they collect because it is not open source. That is a problem in its own right as I can&rsquo;t audit what the Play Services are collecting on me. Sadly using Android without the Play Services whilst not impossible is a less desirable experience. A lot of developers utilise a lot of the Google Play API&rsquo;s in their apps which will mean that some apps will either malfunction or not behave as designed when Google Play services are not installed. This is where microG enters the arena. It bridges the gap between usability and open. Google may still get some metrics whilst using microG but its just enough to ensure that the various apps I want to use now work. Its not perfect but a pragmatic compromise.</p><h1 id=why-did-i-use-lineageos-for-microg>Why did I use LineageOS for microG</h1><p>The official LineageOS team took a stance that they would not allow signature spoofing. This was required by microG to pretend to be the Google Play Services so apps called its reimplemented API&rsquo;s. This was largely driven by security concerns which is somewhat fair however with this being a nessecity for microG an unofficial fork was created and the <a href=https://lineage.microg.org/>LineageOS for microG</a> custom ROM was born. This ROM was LineageOS with MicroG built in and was arguably the easiest way for me to get both LineageOS and microG in one convenient package.</p><h1 id=why-migrate-away-from-lineageos-for-microg>Why migrate away from LineageOS for microG</h1><p><a href=https://review.lineageos.org/c/LineageOS/android_frameworks_base/+/383574>LineageOS/android_frameworks_base change 383574</a> has now allowed the microG to signature spoof. This has made LineageOS for microG custom rom redundant. Whilst they&rsquo;ve not stopped releases immediately I am predicting in the near future they may do this.</p><p>Other than speculation there are a couple of minor benefits to moving back to the official LineageOS release, most notably frequent updates. For my device there is a weekly release for the official LineageOS custom ROM. As a result of this I will get security fixes and any other changes quicker than LineageOS for microG custom ROM which was a monthly release.</p><h1 id=how-am-i-migrating>How am I migrating</h1><p>Inconveniently its not as simple as installing the official LineageOS release over LineageOS for MicroG so the plan is as follows:</p><ol><li>Take a full nandroid backup just incase it goes horribly wrong and I need to revert</li><li>Backup all applications and their data</li><li>Install latest phone firmware</li><li>Install LineageOS Recovery</li><li>Install LineageOS</li><li>Restore all applications and their data</li><li>Install microG</li></ol><h1 id=prerequisite>Prerequisite</h1><p>adb and fastboot needs to be installed on the computer. On a Debian based system this is as simple as running the following command in the terminal.</p><pre tabindex=0><code>sudo apt install adb fastboot
</code></pre><h1 id=take-full-nandriod>Take full nandriod</h1><p>To do this I will be using <a href=https://xdaforums.com/t/recovery-12-13-14-official-orangefox-recovery-project-r11-1.4472617/>OrangeFox recovery</a>. I followed <a href=https://wiki.orangefox.tech/en/guides/installing_orangefox>this guide</a> to get OrangeFox recovery installed.</p><p>Once booted into OrangeFox recovery I then took a backup of boot, data & super partitions. This should hopefully be enough for me to abort and revert if nessecary.</p><p>Once this has done I took a copy of the Fox directory from the phone onto the computer.</p><h1 id=backup-all-applications-and-their-data>Backup all applications and their data.</h1><p>To do this we are utilising the built in backup functionality in LineageOS which is <a href=https://github.com/seedvault-app/seedvault>seedvault</a>. This is not a perfect solution as we&rsquo;re depending on app makers to implement backups the Android standard way. As a result of doing this I am expecting to lose my Whatsapp chat history. I could backup to Google Drive if I really was that precious over the chat history but there is nothing that I need to keep there and I was not willing to backup to Google Drive.</p><p>To turn on seedvault backups I did this in Settings > System > Backup > Seedvault Backup</p><p>Once I completed my backup I took a copy of the .SeedVaultAndroidBackup directory onto the computer.</p><h1 id=install-latest-phone-firmware>Install latest phone firmware</h1><p>As I have been running LineageOS for quite a while there is a possibility that my phone firmware is out of date. On Xiaomi phones these usually get delivered as part of the MIUI update. Fortunately the kind folks at <a href=https://xiaomifirmwareupdater.com/>Xiaomi Firmware Updater</a> provide flashable firmware meaning you do not need to install MIUI to get firmware updates. Firmware updates can bring driver fixes and security updates to your device so there is value to doing this periodically. Now seems a perfect time given we&rsquo;re doing a full system refresh.</p><p>To do this I downloaded the latest firmware from Xiaomi Firmware Updater. I then rebooted my device into recovery. Once in recovery I went to Apply Update > Apply from ADB</p><p>Once ADB is enabled I should be able to run this command from the directory where I downloaded the firmware from inside my terminal:</p><pre tabindex=0><code>adb sideload fw_alioth_miui_ALIOTHEEAGlobal_V14.0.11.0.TKHEUXM_067e9d6f67_13.0.zip
</code></pre><p>A popup on the phone will say Signiture verification Failed install anyway? I selected yes here. This is due to the flashable firmware not being signed by the LineageOS Team.</p><h1 id=install-lineageos-recovery-and-lineageos>Install LineageOS Recovery and LineageOS</h1><p>To avoid reinventing the wheel the folks over at LineageOS have a very good guide on how to install LineageOS for the Xiaomi Poco F3 on <a href=https://wiki.lineageos.org/devices/alioth/install/variant1/>their website</a>.</p><p>If you&rsquo;re coming from a custom rom before some of these steps are not nessecary such as unlocking bootloaders. It is worth noting at this point I will be resetting the phone to factory settings so be sure to take a copy of anything important as data will be lost beyond this point.</p><p>Once those steps are complete I rebooted the device and follow the wizard to setup the device for the first time.</p><h1 id=restoring-applications-and-data>Restoring applications and data</h1><p>As a result of resetting the phone I need to copy our backup onto the phone. To do this I copied the .SeedVaultAndroidBackup from the computer back onto the phone. Once thats completed open the phone dialer and type <code>*#*#7378673#*#*</code>. This will open up the seedvault restore process.</p><p>I was plesantly surprised at what a good job seedvault did at restoring my apps. Only a couple had issues being restored. One being F-Droid and the others being microG components. Both will be installed in due course.</p><p>The rest of my restore was internal storage items such as photos etc which I was able to move onto the device via the file explorer on my computer.</p><h1 id=install-microg>Install microG</h1><p>The final piece of the jigsaw. To install microG I need to install <a href=https://f-droid.org/>F-Droid from the projects homepage</a>. Once this is done I can go to settings in F-droid and add the microG repository which can be found on the <a href=https://microg.org/download.html>microG project website</a>. Once I&rsquo;ve added this I then installed microG Service, microG Service Framework Proxy & microG companion from the F-droid repository. Once completed I rebooted the phone as I patched some key system components. Once rebooted I navigate to microG setting and select self check. I saw a lot of unchecked boxes so click on them to give microG the nessecary permissions to function. Once this has been completed I have done the minimum to get get microG running.</p><h1 id=optional-tasks-that-would-be-worth-doing>Optional tasks that would be worth doing</h1><p>If you&rsquo;re following along with what I did and this is your first time running microG you may want to consider these extra tasks:</p><ul><li><p>You may want to return to the microG settings and turn on Cloud Messaging. This is used by a lot of applications to handle push notifications.</p></li><li><p>You may also want to install a location backend to improve the quality of your location services. There are many backend you can choose for this. I personally use the <a href=https://f-droid.org/en/packages/org.microg.nlp.backend.ichnaea/>MozillaNlpBackend</a> but you can find a list of them on the <a href="https://github.com/microg/UnifiedNlp?tab=readme-ov-file#usage">UnifiedNlp GitHub repository</a> which is maintained by the microG project.</p></li><li><p>You may also want to install the <a href=https://f-droid.org/packages/com.aurora.store/>Aurora Store</a>. This is an open source Google Play client that you can use to install your apps. Considerably more privacy respecting in comparision to the official Google Play client.</p></li></ul><h1 id=conclusion>Conclusion</h1><p>This was a relatively uneventful OS swap. All worked fairly seamlessly with the exception of losing Whatsapp chat history which could have been avoided if I was willing to back it up to Google Drive. A successful change which will help to prolong the life of my Xiaomi Poco F3. The device has proven to be good value for money up to this point and I will probably stick with it for the foreseeable especially when the current phone market is not offering me much more than what I&rsquo;ve got.</p></article></main><footer id=footer>Copyright Â© 2021 - 2024 Sam Tripp - All Rights Reserved</footer></body></html>